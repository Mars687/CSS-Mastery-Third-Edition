# 第一章  奠定基础

人类是一个天生好奇的物种。我们只是喜欢摆弄东西。当我们把新的鹦鹉VR无人机放在办公室的时候，我们甚至还没看说明书就把它摔碎了。我们喜欢自己动手做事情，并建立自己的思维模式。我们蒙混过关，只有在出错或违背我们的期望时才转向手册。

学习层叠样式表（CSS）的最好方法之一是直接跳转并开始修修补补。事实上，这可能是你们中有多少人学会了编写代码；通过从博客中获取提示，查看源代码来了解您最喜爱的设计者是如何取得特定效果的，以及浏览开源代码库以获取代码片段。你几乎肯定没有开始阅读完整的规范，这足以让任何人打瞌睡。

修修补补是一个很好的开始，但是如果你不小心，你可能最终会误解一个重要的概念或问题。我们知道，我们已经做过几次了。在本章中，我们将回顾一些基本但经常被误解的概念，并向您展示如何使HTML和CSS保持清晰和良好的结构。

在本章中您将了解到：

* 可维护性的重要性
* HTML和CSS的不同版本
* 未来友好和向后兼容代码的策略
* 为HTML添加意义并使用新的HTML5元素
* 向HTML添加适当的样式挂钩
* 通过ARIA拓展HTML语义，微格式和微数据
* 浏览器引擎模式和验证

## 构建你的代码

大多数人不考虑建筑物的地基。然而，如果没有坚固的地基，大多数建筑物就不会屹立不倒。虽然这本书是关于CSS技术和概念的，但是如果没有一个结构良好且有效的HTML文档来工作，那么你将要学习的大部分内容都是不可能的（或者至少是非常困难的）。

在本节中，您将了解为什么良好结构化和有意义的HTML对基于标准的开发至关重要。您将学习如何为文档添加更多的意义和灵活性，并通过这样做，使您的开发人员的工作更容易。但首先，无论我们使用什么语言，第一个话题都是最重要的。

### 可维护性

可维护性可以说是任何好的代码库的最重要的特性。如果你的代码开始失去结构，变得很难阅读，那么很多事情就变得困难了。如果你正在挣扎在难以理解的和脆弱的代码，添加新的功能，修复漏洞，提高性能都变得更加复杂和令人沮丧。在某些情况下，它变得如此糟糕，开发人员将抵制完全改变，因为几乎每一次，他们这样做，打破了一些东西。这可能会导致一种情况，即没有人喜欢在网站上工作，或在非常糟糕的情况下，进行严格的变更控制过程，在这种情况下，每周只能发布一次，甚至每月一次！

如果您正在构建网站，这些网站将交付给客户或其他开发团队，可维护性就更为重要。关键是要提供易于阅读、意图明确的代码，并对更改进行优化。“唯一不变的就是变化”是一个特别合适用在这的陈词滥调，因为谁的项目没有不断变化的需求，以及不断的特性请求和错误修复呢？

CSS是一种最难维护的语言，作为一种扩展，即使是一个相对较小的站点，样式表也能很快失去控制。其他现代编程语言具有内置的变量、函数和命名空间等特性，所有这些特性都有助于在缺省情况下保持代码结构和模块化。CSS没有这些特性，所以我们需要把它们构建成我们使用语言和构建代码的方式。当我们在书中讨论不同的主题时，你会看到可维护性这一主题几乎贯穿所有内容。

### 标记简史

_网络的力量在于它的普遍性。它的本质在于每个人不论残疾与否都可以访问它。 _

_                                                                                                                                                                                     ——Tim Berners-Lee_

Tim Berners Lee在1990创建了HTML，以格式化科研文档。它是一种简单的标记语言，它允许文本被赋予基本的结构和意义，如标题、列表和定义。这些文档通常呈现很少或根本没有视觉修饰，可以很容易地由计算机索引，并可以使用文本终端、Web浏览器或屏幕阅读器进行阅读。然而，人类是视觉动物，作为普及万维网，HTML开始获得创造表象的影响特征。人们不使用标题元素作为页面标题，而是使用字体和粗体标签的组合来创建特定的视觉效果。表被收编为布局的工具，而不是一个显示数据的方式，人们会使用blockquote元素缩进文本而不是显示引用。HTML很快就失去了赋予内容结构和意义的主要目的，成为字体和表标记的混杂。Web设计者为这种标记提出了一个名称；他们称之为_tag soup_（见图1-1）。

![](/assets/figure1-1.png)

_图1-1 从ABC新闻网2000年8月14日头条故事的标记看到，它使用表格布局和粗体文本大标题。这部分代码缺乏结构，很难理解。_

网络变得一团糟，CSS被创建来帮助整理东西。CSS的主要目的是让已经发现他们的方式进入HTML被提取并投入自己的系统表象规则；分离内容和表现。这鼓励了含义\(meaning\)和语义\(semantics\)返回HTML文档。表象的标签如字体标签可以被抛弃和布局表格可以慢慢取代。这对Web的可访问性和速度是一个好处，但CSS也为Web设计者和开发人员提供了许多好处：

* 专为控制视觉风格和布局而设计的语言。
* 可以在一个站点上更容易重用的样式
* 通过分离关注点来改进代码结构

### 关注分离

关注分离是软件开发中常见的概念。在Web上，它不仅可以应用于标记和样式的分离，还可以应用于样式的编写。事实上，这是确保可维护代码的主要方法之一。

UNIX开发社区中有一个短语，通过“小块，松散地连接”这个短语来表达这个概念。由于它与其他组件“松散连接”，所以该模块可以很容易地重用到系统的其他部分中。UNIX中的“小块”可以是单词计数功能，它可以处理你输入的任何文本。在Web开发中，“小部件”可以是产品列表组件，如果松散耦合，则可以跨站点的多个页面或布局的不同部分重用。

你可以把这些小代码看作乐高积木。每一块砖都非常简单，但它们可以通过多种方式连接在一起，创造出极其复杂的物体。在本书的结尾部分，在第12章中，我们将回到这个主题，并研究如何以结构化的方式使用该策略。

### HTML和CSS的不同版本

CSS有各种不同的版本，或者说是“水平”（levels），最好知道这些版本意味着什么的历史背景，以及它们如何影响你应该或不应该使用的CSS的特性。万维网联盟（W3C）是一个标准化Web技术的组织，它的每一个规范在它最终成为W3C推荐之前都要经过几个阶段的开发。CSS 1在1996年底成为W3C推荐标准，包含了非常基本的属性，如字体、颜色和边距。CSS 2在1998成为了一个建议，并添加了高级概念，如浮动和定位，以及新的选择器，如子、相邻的兄弟和通用选择器。

CSS 3是一个稍微不同的怪兽。事实上，并没有CSS 3，而是每个分级模块独立的集合。当一个模块的规范不断完善现有的概念，3级开始了。如果这是一项全新的技术，它将从1级开始。当使用CSS 3这个术语时，它通常指任何新的足以成为模块规范的一部分。模块的示例包括“CSS背景和边框级别3”、“选择器级别4”和“CSS网格布局级别1”。这种模块化方法允许不同规范以不同的速度移动，并且一些级别的3规范，如“CSS颜色级别3”已经作为推荐发布。其它的则处于候选推荐状态，还有许多正处于工作草案状态。

虽然CSS 3在CSS 2发布的时候就开始了工作，但这些新规范的进展最初是缓慢的。为此，在2002，W3C发布了CSS 2修订版1。CSS 2.1修正了CSS 2中的错误，删除了浏览器中不支持或不存在的功能，并且通常清理内容以提供更精确的浏览器实现画面。CSS 2.1在2011年6月就已经达到了推荐状态，在CSS 3启动后的十年内已经达到了推荐状态。这让您了解标准机构和浏览器制造商需要多长时间才能确切地了解这些技术是如何工作的。也就是说，当功能处于草稿阶段时，浏览器通常会为功能提供实验支持，而在候选推荐阶段，通常情况下是相当稳定的。某种东西成为可用技术的日期通常比它成为推荐的日期早得多。

HTML的历史也同样复杂。HTML 4.01在1999成为了一个推荐，在这一点上W3C将注意力转移到XHTML 1上。XHTML 1.1本来是要遵循的，但是它强加的严格程度证明是不切实际的，它在Web开发社区的成员中不受欢迎。

2004年，一些公司组成了Web超文本应用技术工作组（WHATWG），开始研究一套新的规范。W3C在2006承认了这项工作的必要性，并参与了这项工作。2009年，W3C完全放弃了XHTML，并正式接受WHATWG的新标准，已经众所周知的HTML5。最初，WHATWG和W3C协调工作制定标准，但是合作的过程中，他们的关系变得复杂。如今，他们编辑两个独立的标准，来自WHATWG被称为HTML，而来自W3C的被称为HTML5。我们知道，这有点傻。幸运的是，这两个标准非常接近，所以说HTML5作为单一的东西仍然是有意义的。

设计者和开发人员经常问他们应该使用哪一种HTML或CSS版本，但是没有简单的答案。虽然这些规范为标准和开发Web技术所做的工作提供了一个焦点，但它们在日常工作中与设计者和开发人员基本上不相关。重要的是知道HTML和CSS在浏览器中实现了哪些部分，以及这些实现有多健壮和无错误（bug-free）。它们是应该谨慎使用的实验特性吗？或者它们健壮且测试良好，在大量浏览器中有匹配的实现吗？

了解浏览器支持的状态是今天写CSS和HTML中最棘手的部分之一。有时事情似乎进展得很快，你必须努力工作才能跟上。在其他时候，它会慢得令人沮丧。在这本书中，你会看到HTML和CSS的各种功能的浏览器支持说明，以及如何以及何时应该考虑使用它们的提示。不可避免地，这里打印的信息将过时，因此重要的是要跟上这些信息。

有几个好地方可以开始学习浏览器支持。CSS属性，“Can I use”网站（[http://caniuse.com） 允许你搜索属性或套件的性能，完成对浏览器所占的百分比的统计数据支持，在桌面和移动浏览器。另一个雄心勃勃的计划，是（http://webplatform.org），W3C和几个浏览器制造商和行业巨头之间的合作，试图收集和合并各自的文件支持CSS，HTML，JavaScript](http://caniuse.com）允许你搜索属性或套件的性能，完成对浏览器所占的百分比的统计数据支持，在桌面和移动浏览器。另一个雄心勃勃的计划，是http://webplatform.org，W3C和几个浏览器制造商和行业巨头之间的合作，试图收集和合并各自的文件支持CSS，HTML，JavaScript) API，等等。然而，由于大型项目容易做，将这一规范的Web技术文档集合起来需要花费大量的时间。当这个发生的时候，Mozilla的开发文档，MDN（[http://developer.mozilla.org），通常被认为是黄金标准。](http://developer.mozilla.org），通常被认为是黄金标准。)

在讨论浏览器支持时，重要的是要接受并非所有浏览器都是平等的，而且它们永远不会是。现在很少有浏览器支持CSS 3特性。例如，灵活盒布局（或flexbox短）未正确支持Internet Explorer版本11之前和在Safari直到版本6.1。即使你需要支持旧的浏览器，这并不意味着flexbox毫无用处。你可能会避免使用flexbox为站点的核心布局，但你仍然可以选择使用它在一个特定的组成部分，其强大的功能是非常有用的，并确保在浏览器不理解性质的可接受的退路。有能力判断要求向后兼容性还是未来友好代码，这是定义真正的CSS大师的一部分。

